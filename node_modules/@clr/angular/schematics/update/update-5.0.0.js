"use strict";
/*
 * Copyright (c) 2016-2021 VMware, Inc. All Rights Reserved.
 * This software is released under MIT license.
 * The full license information can be found in LICENSE in the root directory of this project.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const tasks_1 = require("@angular-devkit/schematics/tasks");
const update_json_file_1 = require("../utility/update-json-file");
const clarityCorePackageName = '@cds/core';
const clarityAngularPackageName = '@clr/angular';
const clarityCorePackageUpdateVersion = '^5.0.0';
function default_1() {
    return (host, context) => {
        update_json_file_1.updateJsonFile(host, 'package.json', json => {
            // Do nothing if @cds/core is already a dependency
            const deps = (json === null || json === void 0 ? void 0 : json.dependencies) || {};
            if (Object.keys(deps).includes(clarityCorePackageName)) {
                return;
            }
            if (!json.dependencies) {
                json.dependencies = {};
            }
            const clarityAngularVersion = json.dependencies[clarityAngularPackageName];
            // Do nothing if @clr/angular is not a dependency
            if (!clarityAngularVersion) {
                return;
            }
            // Add the same version of @cds/core as
            // the version of @clr/angular that's in the package.json
            json.dependencies[clarityCorePackageName] = clarityCorePackageUpdateVersion;
        });
        context.addTask(new tasks_1.NodePackageInstallTask());
    };
}
exports.default = default_1;
//# sourceMappingURL=update-5.0.0.js.map